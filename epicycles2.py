import random
import numpy as np
from manim import *
from svg.path import parse_path

def integrate(func, a, b, *, dx=0.01):
    return sum(func(x) * dx for x in np.arange(a, b, dx))

class SVGPath(VMobject):
    def __init__(self, path_str, *, num_points=500, **kwargs):
        self.path       = parse_path(path_str)
        self.num_points = num_points

        super().__init__(**kwargs)

    def point(self, alpha):
        z = self.path.point(alpha)

        return np.array([z.real, z.imag, 0])

    def generate_points(self):
        step = 1 / self.num_points

        points = [self.point(x) for x in np.arange(0, 1, step)]
        self.start_new_path(points[0])
        self.add_points_as_corners(points[1:])
        self.add_line_to(self.point(1))

        self.flip(RIGHT)
        self.center()

        return self

class FourierEpicyclesMObject(VMobject):

    def __init__(
            self,
            complex_points,
            num_coefs=None,
            speed_factor=1.,
            # parameters about the epicycles
            circles_color="#06d6a0",
            circles_width=1,
            circles_opacity=1,
            vectors_color="#ef476f",
            vectors_width=4,
            vectors_opacity=1,
            # parameters about the background shape behind the epicycles
            bg_shape_color=GRAY_C,
            bg_shape_stroke_width=1,
            bg_shape_opacity=1,
            # parameters about the path traced
            path_color=TEAL,
            path_width=4,
            path_opacity=1,
            **kwargs):
        super().__init__(**kwargs)
        self.complex_points = complex_points
        self.N = len(self.complex_points)
        self.K = num_coefs if num_coefs is not None else self.N
        self.speed_factor = .1 * speed_factor * self.N
        self.circles = VGroup()
        self.vectors = VGroup()
        self._init_bg_shape(bg_shape_color, bg_shape_stroke_width, bg_shape_opacity)
        self._init_epicycles(circles_color, circles_width, circles_opacity,
                             vectors_color, vectors_width, vectors_opacity)
        self._init_path(path_color, path_width, path_opacity)

    def _init_bg_shape(self, color=GRAY_C, stroke_width=1, stroke_opacity=1):
        real_points = list(map(complex_to_R3, self.complex_points))
        self.path = VMobject(stroke_color=color,
                             stroke_width=stroke_width,
                             stroke_opacity=stroke_opacity) \
            .set_points_as_corners([real_points[-1], *real_points])
        self.add(self.path)
        return self

    def _init_epicycles(self, c_color, c_width, c_opacity, v_color, v_width, v_opacity):
        def create_one_epicycle(radius, angle):
            circle = Circle(radius=radius,
                            stroke_color=c_color,
                            stroke_width=c_width,
                            stroke_opacity=c_opacity)
            vector = Line(ORIGIN, circle.get_right(),
                          stroke_color=v_color,
                          stroke_width=v_width,
                          stroke_opacity=v_opacity)
            return VDict([("circle", circle), ("vector", vector)]).rotate(angle)

        fft = np.fft.fft(self.complex_points) / self.N
        self.epicycles = VGroup(VDict([("vector", Dot(radius=0))]))
        for i, k in enumerate([int(i / 2) * (-1) ** i for i in range(1, self.K + 1)]):
            epicycle = create_one_epicycle(radius=abs(fft[k]), angle=np.angle(fft[k]))
            epicycle.set(previous=self.epicycles[i]["vector"].get_end)
            epicycle.set(speed=TAU * k / self.N)
            epicycle.move_to(epicycle.previous())
            epicycle.add_updater(lambda e, dt: e.move_to(e.previous()).rotate(e.speed * dt * self.speed_factor))
            self.epicycles.add(epicycle)
            self.circles.add(epicycle["circle"])
            self.vectors.add(epicycle["vector"])
        self.add(self.epicycles)
        return self

    def _init_path(self, color, width, opacity):
        self.trace = TracedPath(self.epicycles[-1]["vector"].get_end, #min_distance_to_new_point=.01,
                                stroke_color=color, stroke_width=width,
                                stroke_opacity=opacity)
        self.add(self.trace)
        return self

    def get_epicycles(self):
        return self.epicycles

    def get_circles(self):
        return self.circles

    def get_vectors(self):
        return self.vectors

class Anime(Scene):
    def construct(self):
        # get an array of complex points
        N = 1000
        path_str = "m 2.1755734,3.3459207 c -0.014081,-0.013056 -0.0256,-0.027675 -0.0256,-0.032488 0,-0.00481 0.010618,-0.015709 0.023599,-0.024213 0.022099,-0.014478 0.024772,-0.014402 0.042047,0.00124 0.010147,0.00918 0.018448,0.01418 0.018448,0.011108 0,-0.00307 -0.00849,-0.019975 -0.018866,-0.037562 -0.018866,-0.031976 -0.018866,-0.031976 0.00467,-0.027476 0.012945,0.00247 0.023538,0.00198 0.023538,-0.00106 0,-0.00306 -0.017649,-0.014574 -0.03922,-0.02558 -0.038515,-0.019648 -0.039818,-0.0197 -0.072415,-0.0029 -0.018257,0.00941 -0.034845,0.018228 -0.036862,0.019594 -0.00201,0.00135 0.00146,0.00866 0.00773,0.016208 0.00627,0.00755 0.010019,0.023419 0.00834,0.035265 -0.00198,0.014036 -0.010389,0.02258 -0.024118,0.024529 -0.011713,0.00168 -0.022492,-0.00248 -0.024279,-0.00934 -0.00177,-0.00678 -0.00808,-0.027035 -0.014031,-0.045003 -0.00941,-0.02842 -0.00838,-0.035964 0.00793,-0.05802 0.010311,-0.013942 0.018744,-0.031745 0.018744,-0.039557 0,-0.00781 0.0066,-0.030695 0.014663,-0.050849 0.00898,-0.02244 0.011783,-0.025448 0.024738,-0.032059 0.00874,-0.010413 0.00396,-0.025123 0.016979,-0.028202 0.021439,-0.00506 0.023878,-0.010467 0.025832,-0.05714 0.00198,-0.047431 -5.163e-4,-0.054509 -0.031452,-0.088743 -0.019141,-0.021188 -0.030737,-0.041849 -0.026936,-0.047999 0.00433,-0.00701 0.021143,-0.00881 0.047888,-0.00515 0.041215,0.00565 0.041215,0.00565 0.035628,-0.029268 -0.00307,-0.019204 -0.028778,-0.081346 -0.057121,-0.138094 -0.047877,-0.095857 -0.05152,-0.1078127 -0.051328,-0.1684845 1.72e-4,-0.051687 0.00618,-0.079333 0.028829,-0.1325692 0.023392,-0.05497 0.027466,-0.074497 0.022294,-0.1068452 -0.00458,-0.028646 -0.017434,-0.051453 -0.04652,-0.082549 -0.022105,-0.023632 -0.043901,-0.052996 -0.048435,-0.065251 -0.00824,-0.022284 -0.00824,-0.022284 -0.025194,0.00528 -0.00932,0.01516 -0.02679,0.042505 -0.038814,0.060768 -0.012025,0.018263 -0.021863,0.045295 -0.021863,0.060071 0,0.014776 0.00475,0.041881 0.01054,0.060233 0.0058,0.018352 0.014147,0.042893 0.018554,0.054536 0.00441,0.011644 0.016783,0.095639 0.027497,0.186656 0.013401,0.1138281 0.00719,0.1625132 0.00948,0.1688212 0.0037,0.019352 0.011973,0.039767 0.016511,0.058939 0.00597,0.025875 0.01086,0.061282 0.01086,0.078681 0,0.0174 0.00729,0.074348 0.020023,0.1256683 0.017724,0.071409 0.024046,0.078799 0.027748,0.087373 0.00944,0.1422133 0.059732,0.2254264 0.097157,0.327221 -0.00148,0.016066 0.045302,0.046517 0.056318,0.097452 0.011967,0.055334 0.030454,0.1319838 0.041081,0.1703331 0.010627,0.038349 0.032393,0.087926 0.048368,0.1101712 0.02258,0.031443 0.027815,0.046598 0.023518,0.068086 -0.0042,0.020996 -8.481e-4,0.031511 0.01389,0.043744 0.010681,0.00886 0.039997,0.046347 0.065148,0.083313 0.025152,0.036966 0.06078,0.07869 0.079175,0.09272 0.025499,0.01945 0.0321,0.03012 0.027789,0.044915 -0.00311,0.010675 -0.012049,0.055147 -0.019861,0.098829 -0.013559,0.075807 -0.016311,0.081458 -0.060418,0.1241518 -0.025416,0.024601 -0.046062,0.051932 -0.04588,0.060735 1.72e-4,0.0088 0.0061,0.02642 0.013143,0.039148 0.011296,0.020406 0.010696,0.026112 -0.00506,0.048239 -0.01711,0.024029 -0.017227,0.027811 -0.00277,0.088983 0.012714,0.053777 0.013857,0.089765 0.00722,0.2274043 -0.00433,0.089934 -0.00762,0.1908474 -0.00731,0.2242515 3.268e-4,0.033404 0.0051,0.1090891 0.010644,0.1681889 0.00878,0.093566 0.014228,0.1153276 0.04218,0.1683735 0.017654,0.033506 0.043456,0.078908 0.057335,0.1008923 0.013877,0.021985 0.031331,0.042312 0.038784,0.045172 0.00908,0.00348 0.011685,0.012628 0.0079,0.027707 -0.00317,0.012627 -4.793e-4,0.028746 0.00615,0.036719 0.00886,0.010681 0.00924,0.019356 0.00153,0.034918 -0.00565,0.011387 -0.011587,0.029115 -0.013197,0.039393 -0.00268,0.017071 -0.010596,0.018789 -0.091584,0.019853 -0.048762,6.315e-4 -0.1054769,-0.00192 -0.1260334,-0.00568 h 2.85e-5 c -0.04219,-0.00394 -0.09342,4.357e-4 -0.1286582,-0.00159 -0.073628,0.00303 -0.080766,0.00172 -0.09053,-0.016524 -0.00148,-0.021722 -0.010896,-0.040763 -0.015141,-0.057605 -0.018733,-0.032597 0.00912,-0.059376 0.024056,-0.090671 0.012948,-0.017574 0.020496,-0.047294 0.024684,-0.097179 0.00373,-0.044423 0.00162,-0.094327 -0.00555,-0.1306971 -0.00636,-0.03235 -0.02117,-0.075697 -0.032907,-0.096318 C 2.1150913,5.1385188 2.0872703,5.0759928 2.0650023,5.0201926 2.0261253,4.9227716 2.0224593,4.9173369 1.9727873,4.883507 1.9443363,4.864131 1.9141783,4.840407 1.9057683,4.830789 1.8973583,4.821169 1.8790593,4.78597 1.8651023,4.752566 1.8511453,4.719162 1.8301513,4.666603 1.8184493,4.6357684 c -0.015449,-0.040708 -0.029278,-0.060798 -0.050442,-0.073291 -0.026382,-0.015573 -0.029159,-0.021601 -0.029159,-0.063302 0,-0.040618 -0.00278,-0.047149 -0.023461,-0.05501 -0.012904,-0.00491 -0.041285,-0.00675 -0.063071,-0.0041 -0.037469,0.00457 -0.040922,0.00292 -0.063892,-0.03056 -0.013356,-0.01946 -0.03748,-0.042949 -0.05361,-0.052195 -0.024736,-0.014179 -0.020423,-0.010438 -0.025558,-0.022938 L 1.4688284,4.2292899 c 0.00368,-0.017986 0.011281,-0.060519 0.016886,-0.094515 0.00561,-0.033996 0.01017,-0.073942 0.010144,-0.088766 -2.79e-5,-0.014824 -0.00988,-0.043202 -0.021904,-0.063059 -0.021856,-0.036105 -0.021856,-0.036105 -0.029109,0.070078 -0.00399,0.058402 -0.00707,0.119525 -0.00684,0.1358306 2.117e-4,0.016306 0.00575,0.039432 0.012271,0.051392 l 0.032978,0.1030868 c 0.00306,0.00797 0.030747,0.03655 0.027547,0.049259 -0.00319,0.012707 -0.02298,0.039615 -0.043977,0.059792 -0.028904,0.027774 -0.036708,0.041316 -0.032126,0.055752 0.00486,0.015321 -0.00137,0.023306 -0.031709,0.040634 -0.031092,0.017757 -0.037716,0.026516 -0.037505,0.049597 1.408e-4,0.015417 0.00619,0.055362 0.013432,0.088766 0.017387,0.085506 -0.00506,0.1365921 -0.037632,0.2173427 -0.012235,0.024465 -0.032926,0.062708 -0.045981,0.084984 -0.048759,0.090382 -0.088797,0.1929892 -0.098405,0.2835088 0.011839,0.096794 0.049621,0.1876099 0.039102,0.2587443 -0.010627,0.026265 -0.020619,0.058267 -0.022204,0.071115 -0.00288,0.023359 -0.00288,0.023359 -0.147712,0.030419 -0.079656,0.00388 -0.22044614,0.00598 -0.31286674,0.00467 -0.168038,-0.00239 -0.168038,-0.00239 -0.1747589,-0.039763 -0.0037,-0.020556 -0.0045,-0.048861 -0.00179,-0.0629 0.00391,-0.020217 0.012542,-0.027573 0.0415,-0.03537 0.022699,-0.00611 0.052536,-0.026048 0.078693,-0.052581 0.033765,-0.034249 0.046562,-0.041623 0.064446,-0.037135 0.013895,0.00349 0.026515,5.229e-4 0.033447,-0.00781 0.00612,-0.00738 0.031006,-0.026166 0.055297,-0.041753 0.025427,-0.016317 0.053401,-0.044772 0.065931,-0.067067 0.011971,-0.021299 0.024991,-0.053027 0.028933,-0.070506 0.00394,-0.017478 0.00346,-0.06006 -0.00108,-0.094626 -0.00453,-0.034567 -0.012497,-0.1124411 -0.017696,-0.1730543 -0.0052,-0.060613 -0.020315,-0.1531171 -0.033591,-0.2055639 -0.013276,-0.052448 -0.030828,-0.1027784 -0.039004,-0.1118466 -0.00818,-0.00907 -0.033071,-0.027989 -0.055324,-0.042047 -0.025872,-0.016344 -0.040414,-0.032297 -0.040333,-0.044247 7.07e-5,-0.010278 0.00402,-0.024854 0.00879,-0.03239 0.00549,-0.00869 0.00502,-0.018092 -0.00129,-0.025696 -0.00547,-0.0066 -0.025691,-0.011993 -0.044925,-0.011993 -0.021624,0 -0.044708,-0.00766 -0.060483,-0.020068 -0.02037,-0.01602 -0.024455,-0.025362 -0.020262,-0.046327 0.00436,-0.021795 -0.00265,-0.035462 -0.041234,-0.080378 -0.025567,-0.029765 -0.055256,-0.072033 -0.065976,-0.093929 -0.01949,-0.03981 -0.01949,-0.03981 0.00949,-0.072819 0.01594,-0.018155 0.041136,-0.057004 0.05599,-0.086331 0.014854,-0.029328 0.039459,-0.068923 0.054676,-0.087989 0.024259,-0.030396 0.028603,-0.045361 0.035259,-0.1214699 0.00417,-0.047742 0.00656,-0.149874 0.00529,-0.2269605 -0.00126,-0.077086 -0.00615,-0.157771 -0.010857,-0.1792992 -0.00702,-0.032093 -0.00502,-0.047237 0.011119,-0.084094 0.016259,-0.037135 0.021051,-0.0742 0.02756,-0.2131412 0.00433,-0.092504 0.010445,-0.1892124 0.013581,-0.2149077 0.00313,-0.025695 0.010254,-0.061436 0.015817,-0.079423 0.00556,-0.017986 0.018949,-0.046732 0.032233,-0.061848 0.21767044,-0.2476935 0.2129894,-0.2973335 0.2132246,-0.3008904 2.117e-4,-0.00781 0.00183,-0.00581 0.00595,-0.043375 0.00336,-0.030647 0.010723,-0.057255 0.016347,-0.05913 l -9.9e-6,1e-7 c 0.00639,-0.00213 0.00239,-0.0171 -0.010655,-0.039878 -0.020882,-0.036469 -0.020882,-0.036469 0.00481,-0.060382 0.014132,-0.013152 0.026081,-0.026896 0.026552,-0.030542 4.698e-4,-0.00364 0.00248,-0.071803 0.00448,-0.1514589 0.00199,-0.079656 0.005,-0.1700575 0.00668,-0.2008921 0.00188,-0.034432 -0.00303,-0.075891 -0.012716,-0.107454 -0.011919,-0.038846 -0.0206,-0.05212 -0.035564,-0.054377 -0.013012,-0.00196 -0.019796,0.00203 -0.019796,0.011653 0,0.00805 -0.01517,0.031429 -0.03371,0.051952 -0.020541,0.022736 -0.047497,0.041026 -0.069002,0.046816 -0.019411,0.00523 -0.060964,0.00892 -0.092341,0.00821 -0.031377,-7.037e-4 -0.062346,0.00289 -0.068819,0.00799 -0.00647,0.0051 -0.022997,0.011952 -0.036718,0.015226 -0.024948,0.00595 -0.024948,0.00595 -0.010081,0.043799 0.013074,0.033285 0.013412,0.048455 0.00279,0.1258047 -0.00664,0.048376 -0.00975,0.094031 -0.0069,0.1014549 0.00434,0.011307 0.011412,0.010416 0.043569,-0.0055 0.021113,-0.010446 0.040902,-0.01648 0.043974,-0.013408 0.00307,0.00307 -0.00304,0.025513 -0.013584,0.049868 -0.019169,0.044283 -0.019169,0.044283 -3.53e-5,0.082014 0.010517,0.020752 0.023813,0.040963 0.029547,0.044914 0.00573,0.00395 0.029796,0.00469 0.053474,0.00164 0.041517,-0.00534 0.044088,-0.00423 0.072248,0.031327 0.018163,0.022932 0.039858,0.038999 0.057397,0.042507 0.025647,0.00513 0.028198,0.00897 0.028198,0.042484 0,0.012008 0.00398,0.042889 0.0013,0.069571 -0.00184,0.018347 -0.1574116,0.2334856 -0.1712958,0.238856 -0.010623,0.00195 -0.03634,-0.016171 -0.05806,-0.026685 -0.021716,-0.010506 -0.044572,-0.019109 -0.050787,-0.019109 -0.01632,-0.036532 -0.047076,-0.06929 -0.066895,-0.1048606 -0.02015,-0.049902 -0.049154,-0.093753 -0.089304,-0.1334068 -0.027502,-0.037967 -0.057773,-0.062576 -0.096714,-0.073762 -0.031307,-0.00878 -0.056921,-0.019615 -0.056921,-0.024069 0.020953,-0.025061 0.048077,-0.037233 0.073741,-0.059796 0.00816,-0.00983 -0.00482,-0.029137 -0.059462,-0.08848 -0.0384442,-0.041747 -0.0832363,-0.1022632 -0.0995388,-0.1344778 -0.028623,-0.056561 -0.0299056,-0.064187 -0.0373472,-0.222089 -0.007099,-0.1506442 -0.006365,-0.1653556 0.009333,-0.1868762 0.009372,-0.012848 0.0259158,-0.024682 0.0367653,-0.026298 0.0114442,0.00505 0.0543879,-0.00173 0.0543879,-0.00173 0.0231921,-0.014794 0.0150993,-0.025608 0.0457731,-0.056906 0.030674,-0.031298 0.079948,-0.073502 0.1094973,-0.093786 0.02955,-0.020285 0.053727,-0.042732 0.053727,-0.049883 0,-0.00715 0.013768,-0.027601 0.030596,-0.045444 0.01886,-0.019998 0.046544,-0.036735 0.072174,-0.043637 0.02953,-0.00795 0.050557,-0.00844 0.072561,-0.00168 0.019364,0.00594 0.041998,0.00635 0.060356,0.00108 0.015459,-0.00732 0.019979,-0.016214 0.029039,-0.023566 0.00541,-0.00663 0.014376,-0.029897 0.024316,-0.04938 0.00994,-0.019483 0.032015,-0.046023 0.049055,-0.058978 0.01704,-0.012954 0.044206,-0.030363 0.060369,-0.038687 0.016163,-0.00832 0.046793,-0.017917 0.068067,-0.021319 0.021274,-0.0034 0.049046,-0.014339 0.061716,-0.024305 0.01267,-0.00997 0.023035,-0.02759 0.023035,-0.039165 0,-0.011575 -0.010679,-0.052265 -0.02373,-0.090424 C 1.094703,0.98550172 1.071649,0.90802942 1.056523,0.85149932 1.041398,0.79496922 1.018425,0.69656521 1.005473,0.63282376 c -0.012952,-0.0637415 -0.029547,-0.12791615 -0.036877,-0.14261042 -0.00733,-0.0146943 -0.016186,-0.0495945 -0.01968,-0.077556 -0.00601,-0.0481373 -0.00518,-0.0511028 0.015694,-0.0557984 0.012125,-0.002728 0.038865,-0.006077 0.059422,-0.007443 0.034164,-0.00227 0.038524,1.2749e-4 0.050741,0.0278841 0.00791,0.0179738 0.020193,0.0303674 0.030093,0.0303674 0.010142,0 0.040787,0.0321854 0.077845,0.0817584 0.043508,0.0582007 0.059784,0.0874382 0.056489,0.10147061 -0.00284,0.0121164 0.00218,0.0258812 0.013061,0.0357216 0.016796,0.015201 0.00319,0.0504471 0.00149,0.0708464 l -0.00552,0.0343061 C 1.246481,0.74513405 1.233228,0.75447005 1.21628,0.73202166 1.195347,0.70429626 1.17822,0.67488316 1.17822,0.66666016 c 0,-0.008223 -0.00448,-0.0177157 -0.00994,-0.0210942 -0.00676,-0.004174 -0.00791,0.005377 -0.00361,0.0298161 0.00348,0.0197776 0.016126,0.0743925 0.028096,0.12136686 0.01197,0.0469743 0.031248,0.1180494 0.04284,0.1579447 0.011591,0.039895 0.022544,0.068133 0.024339,0.062749 0.00179,-0.00538 0.011471,-0.00764 0.021502,-0.00502 0.050158,-0.0063 -0.011465,-0.040339 -0.01455,-0.051759 -0.00356,-0.01379 -0.00784,-0.059535 -0.00952,-0.1016537 -0.00155,-0.0389651 -0.00471,-0.0556384 0.00226,-0.0793068 L 1.287571,0.61987568 c 0.00342,-0.010769 -0.00786,-0.0285294 -0.011129,-0.043342 -0.00338,-0.0153806 -0.00168,-0.0295538 0.00398,-0.0330449 0.00544,-0.003362 0.00989,-0.0167786 0.00989,-0.0298145 0,-0.0130359 0.00866,-0.0358574 0.019235,-0.0507145 0.010579,-0.0148571 0.045075,-0.046897 0.076659,-0.0711998 0.051933,-0.0399618 0.063049,-0.044545 0.1162507,-0.0479326 0.039391,-0.001244 0.044889,-0.009958 0.1527514,-0.008754 0.035105,0.003373 0.05545,0.0124879 0.088714,0.0397448 0.023739,0.0194524 0.046752,0.0442614 0.051141,0.0551312 0.00439,0.0108698 0.019209,0.0489431 0.032935,0.0846072 0.020873,0.0542361 0.023972,0.0735405 0.018941,0.11800493 -0.00476,0.0420669 -0.00316,0.0542581 0.00768,0.058416 0.00753,0.002893 0.017389,0.0233707 0.021905,0.0455121 0.00308,0.0151126 -0.02479,0.0353298 -0.021145,0.0387534 0,0 -0.05927,0.0994546 -0.065259,0.10914474 -0.00483,0.00781 -0.0036,0.01415 0.00319,0.016411 0.00608,0.00203 0.00825,0.00858 0.00483,0.014567 -0.00342,0.00598 -0.00263,0.0076 0.00177,0.0036 0.0044,-0.00401 0.015589,0.00831 0.024858,0.027364 0.00927,0.019057 0.016854,0.042059 0.016854,0.051117 0,0.00906 -0.00446,0.019222 -0.0099,0.022588 -0.00631,0.0039 -0.00411,0.010357 0.00605,0.017786 0.011525,0.00843 0.014209,0.018617 0.00967,0.036716 -0.0059,0.023499 -0.00468,0.024693 0.019645,0.019273 0.014263,-0.00318 0.03266,-0.00757 0.040881,-0.00977 0.020641,-0.02336 0.031951,-0.048126 0.041185,-0.071546 0.014431,-0.0371581 0.054851,-0.12537365 0.089821,-0.19603629 C 2.0739451,0.74579491 2.1008861,0.68798 2.0988431,0.68798 c -0.00205,0 -0.014501,0.004102 -0.027683,0.009113 -0.013182,0.00501 -0.023967,0.0161417 -0.023967,0.0247331 0,0.008591 -0.014998,0.0339236 -0.033329,0.056294 -0.018331,0.0223705 -0.040406,0.0407502 -0.049055,0.0408435 -0.00865,9.154e-5 -0.034229,0.0127079 -0.056843,0.0280316 -0.022615,0.015324 -0.045066,0.027861 -0.049893,0.027861 -0.00482,0 -0.045434,-3.485e-4 -0.036054,-0.01197 0.040547,-0.0502278 0.042273,-0.0573408 0.064428,-0.0876438 0.00898,-0.0122766 0.015625,-0.0160388 0.044464,-0.0452252 0.025396,-0.0257014 0.065095,-0.0693475 0.088222,-0.0969921 0.023126,-0.0276447 0.055712,-0.0630046 0.072414,-0.0785778 0.016702,-0.0155731 0.030368,-0.0352255 0.030368,-0.0436718 0,-0.008446 0.012639,-0.0352872 0.028088,-0.0596463 0.026501,-0.0417871 0.029874,-0.0439543 0.059706,-0.0383577 0.02825,0.0053 0.033436,0.002855 0.048678,-0.0229466 0.00938,-0.015883 0.022627,-0.0288784 0.029432,-0.0288784 0.00681,0 0.029194,0.008581 0.049753,0.0190696 0.020558,0.0104883 0.041239,0.0292209 0.045957,0.0416279 0.0072,0.0189338 -0.00497,0.0489448 -0.075717,0.18678391 -0.046368,0.0903214 -0.09841,0.1992237 -0.1156562,0.24200234 -0.017246,0.042779 -0.054823,0.1245704 -0.083504,0.18175945 -0.028681,0.057189 -0.052148,0.1085369 -0.052148,0.1141067 0,0.00557 0.014716,0.024006 0.032703,0.04097 0.017987,0.016964 0.032704,0.035603 0.032704,0.04142 0,0.0062 0.016433,0.010614 0.039711,0.010668 0.021913,4.59e-5 0.060876,0.00995 0.086934,0.022081 0.036604,0.017044 0.058429,0.037106 0.097063,0.08922 0.027411,0.036977 0.055383,0.082753 0.062157,0.1017249 0.00677,0.018972 0.012502,0.047612 0.012727,0.063645 2.065e-4,0.016033 -0.008,0.055481 -0.018282,0.087664 -0.015934,0.049873 -0.017084,0.064196 -0.00779,0.096991 0.006,0.021163 0.022345,0.051091 0.036334,0.066509 0.01399,0.015416 0.032745,0.042516 0.041678,0.060219 0.012731,0.02523 0.015008,0.045427 0.010533,0.093438 -0.00314,0.033688 -0.011139,0.065455 -0.017772,0.070594 -0.00814,0.0063 -0.012141,0.035182 -0.0123,0.088766 -1.407e-4,0.046634 -0.00669,0.1009001 -0.015877,0.1314474 -0.015642,0.052025 -0.015642,0.052025 0.016714,0.1261414 0.022665,0.05192 0.032369,0.088108 0.032399,0.1208358 2.79e-5,0.025695 -0.00437,0.073951 -0.00978,0.1072347 -0.0054,0.033284 -0.022581,0.1064975 -0.03818,0.1626973 -0.015598,0.0562 -0.030472,0.1076821 -0.033053,0.1144057 -0.00282,0.00734 0.00873,0.018624 0.028907,0.028246 0.018478,0.00881 0.033349,0.018395 0.033046,0.021299 -3.268e-4,0.00291 -0.010679,0.024198 -0.023056,0.047324 -0.012378,0.023126 -0.031432,0.060334 -0.042343,0.082686 -0.01091,0.022351 -0.017713,0.048761 -0.015117,0.058689 0.00259,0.00993 -5.664e-4,0.051083 -0.00703,0.091456 -0.00646,0.040373 -0.00993,0.085816 -0.00771,0.1009851 0.00259,0.017674 -0.00153,0.033155 -0.011476,0.043103 -0.00854,0.00854 -0.029792,0.015524 -0.047233,0.015524 -0.021934,0 -0.041588,0.00867 -0.063747,0.028128 -0.015818,0.013888 -0.01979,0.015539 -0.030665,0.010847 -0.00521,2.17e-5 -0.029053,-0.012283 -0.043133,-0.025338 z"
        path_str2 = "M 4.8942691,7.9299239 C 4.8598892,7.8955417 4.8578768,7.8796706 4.8687569,7.7287082 4.8788424,7.5889504 4.8748458,7.5463775 4.8417377,7.4396128 4.8203678,7.3707471 4.7841212,7.2781912 4.7611574,7.2339232 4.7381888,7.1896553 4.6760421,7.0607399 4.6230381,6.9474488 4.4483538,6.5740595 4.143166,6.1193588 3.9583127,5.9570666 3.855625,5.8669114 3.8358946,5.8393595 3.8092302,5.7488835 L 3.7784989,5.6446058 3.6767015,5.6328041 C 3.5608601,5.6193498 3.5372055,5.5996798 3.4834876,5.4721522 3.462771,5.4229666 3.3893546,5.2700406 3.3203444,5.1323186 3.2513341,4.9945967 3.1550611,4.7652087 3.1064045,4.6225677 3.0577474,4.4799264 3.004293,4.3531598 2.9876174,4.3408631 2.9709493,4.3285677 2.9246267,4.3184352 2.8846986,4.3183177 2.7821183,4.3180699 2.6498223,4.2527927 2.3988941,4.0786213 2.378206,4.0642571 2.3388186,4.0057191 2.3113504,3.9485187 2.2431453,3.8064828 2.2312285,3.5642162 2.2844675,3.4020381 2.3307925,3.2609237 2.3297769,3.2488094 2.2710437,3.2420505 2.204623,3.23441 2.2154232,3.2027454 2.288229,3.1916772 c 0.065506,-0.00994 0.081662,-0.057995 0.023063,-0.068567 -0.066484,-0.01199 -0.071957,-0.038729 -0.00804,-0.039314 0.055136,-5.276e-4 0.058373,-0.0031 0.030407,-0.02433 -0.044877,-0.034063 -0.038849,-0.046647 0.022357,-0.046647 0.029511,0 0.053657,-0.0063 0.053657,-0.014058 0,-0.00773 0.014082,-0.014787 0.0313,-0.015704 C 2.4974191,2.9800704 2.7709681,2.8540984 2.9403455,2.7530227 3.068351,2.6766364 3.1164933,2.6366519 3.1505018,2.5784923 3.2243537,2.4521889 3.3755159,2.0993986 3.3755159,2.0533427 c 0,-0.056265 0.040337,-0.1519692 0.076802,-0.1822064 0.030658,-0.025423 0.056319,-0.095749 0.074541,-0.2042919 0.00632,-0.037623 0.031004,-0.08541 0.056199,-0.1087702 0.040977,-0.037996 0.057186,-0.040954 0.1841456,-0.033607 0.1288707,0.00746 0.1447395,0.0044 0.2135981,-0.041165 0.040911,-0.027075 0.074386,-0.055827 0.074386,-0.063895 0,-0.00807 -0.027196,-0.027573 -0.06043,-0.043345 -0.033237,-0.015772 -0.078907,-0.048344 -0.1014918,-0.072383 -0.022592,-0.024039 -0.053742,-0.043283 -0.069244,-0.042769 -0.020923,7.031e-4 -0.01782,0.00816 0.01206,0.029009 0.0509,0.035504 0.052256,0.065705 0.00225,0.049829 -0.023845,-0.00757 -0.043737,-0.00303 -0.053385,0.012208 -0.010438,0.016454 -0.015469,0.00554 -0.015657,-0.033857 -2.504e-4,-0.053671 -0.034305,-0.086213 -0.037434,-0.035773 -7.473e-4,0.012298 -0.015398,-0.017465 -0.03253,-0.066136 -0.03445,-0.097879 -0.045601,-0.093324 -0.063404,0.025894 -0.00661,0.044268 -0.019489,0.096584 -0.028618,0.1162589 -0.00912,0.019675 -0.048636,0.1262062 -0.087793,0.2367375 C 3.4803484,1.7056114 3.4234325,1.8464637 3.393028,1.9080857 3.3288971,2.0380585 3.1799589,2.1980373 3.0267425,2.3015244 2.9677178,2.3413937 2.8384803,2.4529663 2.7395447,2.5494718 2.6232608,2.6629016 2.5300137,2.7376469 2.4758004,2.7608835 2.3295446,2.823578 2.0652493,2.8875702 1.9525301,2.8875819 c -0.091141,1.11e-5 -0.1241535,0.00952 -0.2076608,0.059808 -0.054611,0.032889 -0.1306,0.06777 -0.1688651,0.077515 C 1.4928748,3.046086 1.2089055,3.2450566 1.1495419,3.3237304 1.0723457,3.4260379 0.9769473,3.6176652 0.91513747,3.794582 0.86596292,3.9353319 0.85391842,3.9968932 0.8537736,4.108211 l -2.0027e-4,0.1385048 0.0760162,0.055926 c 0.0418082,0.030755 0.13212907,0.083122 0.20071317,0.1163709 0.1424658,0.069065 0.2784486,0.07987 0.4313974,0.034283 l 0.087801,-0.026166 -0.044715,0.034615 c -0.1181545,0.091458 -0.436633,0.1384555 -0.60705771,0.08958 -0.0337139,-0.00962 -0.0651451,-0.013729 -0.0698465,-0.00907 -0.017016,0.017021 0.0424817,0.1609256 0.10923811,0.2642112 0.093349,0.1444291 0.3930828,0.4495437 0.5039036,0.5129494 0.305799,0.1749606 0.7946647,0.2007596 0.9838798,0.051922 0.02515,-0.019795 0.045726,-0.02788 0.045726,-0.018008 0,0.025479 -0.092737,0.088296 -0.1732068,0.1173183 -0.03754,0.013541 -0.1218438,0.048925 -0.187343,0.078631 -0.1052721,0.047743 -0.127359,0.051901 -0.1903779,0.035908 C 1.9713955,5.5729115 1.9102827,5.573029 1.8301502,5.5854831 1.7292144,5.6011873 1.6929079,5.5986953 1.5823209,5.5683918 1.3541553,5.5058854 1.1855821,5.4429065 1.1442896,5.4047369 c -0.07261,-0.067119 -0.057977,-0.022969 0.032375,0.097674 0.1734501,0.2316085 0.3798562,0.3817146 0.5530987,0.4022328 0.1188717,0.014082 0.2905297,-0.032537 0.4103179,-0.1114269 0.097399,-0.064143 0.1016752,-0.044127 0.00738,0.03457 -0.08807,0.073499 -0.1883449,0.1003728 -0.3745476,0.1003728 -0.144786,0 -0.1858487,-0.00741 -0.3062847,-0.055141 C 1.2018931,5.7681121 1.0886587,5.6977924 0.99556569,5.5805365 0.94823027,5.5209165 0.8836495,5.4192719 0.85205237,5.3546619 0.79897614,5.2461274 0.78563769,5.2325158 0.67679529,5.1758021 0.5283404,5.0984467 0.47182666,5.0246554 0.36229315,4.7651588 0.25746248,4.5168 0.24027256,4.3659364 0.28987411,4.1295778 L 0.32164922,3.9781594 0.27322344,3.8702543 C 0.19985474,3.7067693 0.19457179,3.595534 0.252618,3.4363839 0.34945646,3.1708699 0.6346832,2.7192126 0.78584316,2.5920203 0.81654108,2.5661859 0.93833243,2.4965915 1.0564894,2.4373623 1.2679756,2.3313496 1.2744028,2.3294477 1.4693496,2.3154715 1.5782658,2.3076215 1.6908195,2.2920565 1.719468,2.2807785 1.748117,2.2695175 1.804458,2.2650745 1.8446698,2.2709285 1.9208268,2.2820245 2.1987253,2.2436345 2.3813891,2.1967765 2.5311593,2.1583491 2.6705257,2.0834939 2.827706,1.9570491 3.1301437,1.7137504 3.3412481,1.3608788 3.5443342,0.75917088 3.575875,0.66571653 3.6078005,0.57315643 3.6152765,0.55348184 3.6370931,0.49607482 3.5152164,0.64571523 3.4500417,0.75636531 3.4032959,0.83572574 3.3928107,0.84597319 3.4014081,0.80388551 3.4241415,0.6926296 3.5400116,0.48982498 3.648862,0.37077551 3.7100096,0.30389638 3.7855613,0.21798932 3.8167534,0.17987 c 0.049064,-0.0599606 0.063536,-0.067681 0.107315,-0.0572488 0.02783,0.006637 0.1471892,0.0140703 0.2652357,0.016527 0.1817994,0.003783 0.2262602,0.0105604 0.2906475,0.0443197 0.070843,0.0371388 0.076015,0.0376343 0.076015,0.007288 0,-0.0388187 0.033085,-0.0754842 0.068113,-0.0754842 0.013847,0 0.076993,0.0412242 0.1403127,0.0916085 0.164706,0.13106064 0.2220475,0.25499558 0.5194758,1.1227908 0.2039968,0.5951921 0.2280868,0.6504676 0.3866393,0.8872048 0.2970686,0.4435564 0.5524911,0.7180006 1.002812,1.0774931 0.4598599,0.3671088 0.6060398,0.5343335 0.7666066,0.8769738 0.113505,0.2422112 0.1613816,0.4555669 0.1614522,0.7194914 4.96e-5,0.2042767 -0.00487,0.238241 -0.057165,0.3934919 -0.1099292,0.3263957 -0.2799461,0.5843272 -0.5025562,0.762435 -0.063687,0.050949 -0.1224691,0.1008265 -0.1306315,0.1108297 -0.00816,0.00994 -0.084624,0.089479 -0.1699179,0.1766204 -0.2368752,0.2420066 -0.4640753,0.345224 -0.7599052,0.345224 -0.2424408,0 -0.4894829,-0.088296 -0.5722508,-0.2045353 L 5.3702646,6.4205653 5.42368,6.458079 C 5.514663,6.521979 5.610776,6.544473 5.7845085,6.542505 5.9417901,6.540735 5.9548213,6.537425 6.0885709,6.465578 6.1654269,6.424293 6.2347397,6.384292 6.2425988,6.376697 6.2504488,6.369057 6.1659468,6.358195 6.0547951,6.352489 5.8316265,6.341017 5.6937089,6.3046928 5.622431,6.2385966 5.4741181,6.1010745 5.4832233,5.8743455 5.6420847,5.7493901 c 0.058414,-0.045951 0.070549,-0.034914 0.029876,0.027163 -0.022381,0.034149 -0.03126,0.081993 -0.030487,0.1641769 9.227e-4,0.098238 0.00907,0.1273426 0.053248,0.1901993 C 5.855311,6.3594181 6.1592208,6.3362967 6.43,6.0749823 6.528704,5.9797303 6.5374326,5.9645782 6.5608901,5.8477207 6.5898371,5.7035102 6.5885271,5.3375141 6.5583001,5.1165541 L 6.5385096,4.9720419 6.388718,4.8166575 C 6.2472607,4.6699228 6.2289014,4.6412542 6.0591105,4.3019957 5.9018949,3.9878645 5.863971,3.9264431 5.7572648,3.8131275 5.4358714,3.4718274 5.2982106,3.2023697 5.2471903,2.8147086 5.2323978,2.7023219 5.2081786,2.5816988 5.1933673,2.5466554 5.1515387,2.4476915 5.0768329,2.140116 5.0111828,1.796556 4.9782886,1.6244032 4.9346585,1.4030639 4.9142325,1.304691 4.8771765,1.126227 4.7936707,0.83071193 4.780297,0.83071193 c -0.00388,0 -0.027506,0.0446723 -0.052506,0.0992716 C 4.6577949,1.0828762 4.6152855,1.1314111 4.5007108,1.1892475 c -0.058136,0.029348 -0.1057023,0.06292 -0.1057023,0.074606 0,0.011684 0.025726,0.04779 0.057165,0.08023 0.044689,0.046106 0.050366,0.058981 0.026018,0.058981 -0.017138,0 -0.051995,-0.020843 -0.077475,-0.046324 -0.036225,-0.036225 -0.049635,-0.041099 -0.061514,-0.022355 -0.0201,0.031699 -0.019513,0.049553 0.00496,0.155608 0.020359,0.088161 0.02271,0.090557 0.1415681,0.1437032 0.066482,0.029726 0.1275941,0.064445 0.1358083,0.077154 0.00823,0.012709 0.019607,0.2726167 0.025317,0.577573 0.01025,0.5469177 0.02491,0.6863548 0.099237,0.9434871 0.00719,0.024906 0.029088,0.031298 0.1071034,0.031298 0.156527,0 0.255197,0.071054 0.2921872,0.2104266 0.032885,0.1239056 -0.016668,0.2910594 -0.1185713,0.3999127 -0.041795,0.044646 -0.04266,0.049976 -0.01782,0.1094426 0.021041,0.05034 0.038774,0.064883 0.09111,0.074705 0.075086,0.014082 0.06911,0.04616 -0.0086,0.04616 -0.081128,0 -0.06592,0.049779 0.027884,0.091272 0.1224739,0.054179 0.1019667,0.094037 -0.025517,0.049588 -0.043337,-0.015116 -0.062883,-0.014905 -0.078589,7.909e-4 -0.015963,0.015963 -0.00395,0.035388 0.05054,0.082036 0.078366,0.067051 0.052792,0.086117 -0.046579,0.034726 -0.050129,-0.025924 -0.057703,-0.025237 -0.1153717,0.010391 -0.033945,0.02097 -0.061719,0.040532 -0.061719,0.04344 0,0.00287 0.012178,0.034448 0.027071,0.070081 0.033971,0.081307 0.00703,0.083662 -0.05322,0.00465 -0.039985,-0.052421 -0.058909,-0.061467 -0.1477298,-0.070636 -0.061902,-0.00642 -0.1109355,-0.00299 -0.1249681,0.00863 -0.017514,0.014529 -0.02311,0.010838 -0.02311,-0.015281 0,-0.018949 -0.024927,-0.068334 -0.055395,-0.1097624 C 4.4343277,4.2623572 4.4052256,4.19734 4.4001241,4.1592926 L 4.3908379,4.0901284 4.2573147,4.0685939 C 4.1838812,4.0567922 4.1197574,4.05115 4.1148204,4.056087 c -0.00494,0.00498 -2.501e-4,0.095563 0.010391,0.2013873 0.01065,0.1058246 0.019395,0.265464 0.019442,0.3547502 3.55e-5,0.089293 0.00527,0.2508748 0.01159,0.3590856 l 0.011519,0.1967466 0.1240066,0.07841 0.1240066,0.078399 0.051191,-0.056048 c 0.065123,-0.071299 0.1689681,-0.078497 0.2278588,-0.015798 0.04628,0.049268 0.077665,0.1754166 0.054116,0.2174982 -0.026935,0.048131 0.015446,0.2029366 0.075498,0.2757944 0.084382,0.1023757 0.070666,0.2715643 -0.027217,0.3356988 -0.037925,0.024849 -0.057851,0.026984 -0.108112,0.011566 -0.053467,-0.016409 -0.06162,-0.014905 -0.06162,0.011449 0,0.055075 0.1213642,0.4555854 0.1794767,0.5922934 0.075389,0.1773491 0.081062,0.1833134 0.1614075,0.1697415 0.086827,-0.01467 0.206771,0.018572 0.2603528,0.07215 0.057614,0.057619 0.06201,0.2115292 0.00689,0.2410312 -0.030336,0.016245 -0.03576,0.037392 -0.03568,0.1392453 5.01e-5,0.096249 0.00884,0.1343108 0.044157,0.1916451 0.0511,0.082967 0.056509,0.1618425 0.017491,0.2552057 -0.072129,0.1726261 -0.2701372,0.2607873 -0.3673625,0.1635633 z"
        path = SVGPath(path_str).scale(0.75)
        path2 = SVGPath(path_str2).scale(0.75)
        complex_points = np.array([complex(*path.point_from_proportion(alpha)[:2]) for alpha in np.arange(0, 1, 1 / N)])
        # normalize them to fit in scene
        complex_points = (complex_points - np.mean(complex_points)) / np.max(abs(complex_points)) * 4
        
        complex_points2 = np.array([complex(*path.point_from_proportion(alpha)[:2]) for alpha in np.arange(0, 1, 1 / N)])
        # normalize them to fit in scene
        complex_points2 = (complex_points2 - np.mean(complex_points2)) / np.max(abs(complex_points2)) * 4
        
        # create my epicycles
        ec = FourierEpicyclesMObject(complex_points, num_coefs=1000, speed_factor=1,
                                     circles_color="#118ab2", circles_opacity=1)
        ec2 = FourierEpicyclesMObject(complex_points2, num_coefs=1000, speed_factor=1,
                                     circles_color="#118ab2", circles_opacity=1)
        self.add(VGroup(ec,ec2).arrange(2*RIGHT))
        self.wait(2*TAU)